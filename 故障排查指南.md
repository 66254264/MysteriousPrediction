# Failed to Fetch é”™è¯¯æ’æŸ¥æŒ‡å—

## ğŸ”´ é—®é¢˜ï¼šç‚¹å‡»æŒ‰é’®åæŠ¥é”™ "Failed to fetch"

è¿™ä¸ªé”™è¯¯è¡¨ç¤ºå‰ç«¯æ— æ³•è¿æ¥åˆ°åç«¯APIã€‚ä»¥ä¸‹æ˜¯å®Œæ•´çš„æ’æŸ¥å’Œè§£å†³æ­¥éª¤ã€‚

---

## âœ… å¿«é€Ÿè§£å†³æ–¹æ¡ˆ

### 1. ç¡®ä¿åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œ

```bash
# åœ¨ backend ç›®å½•ä¸‹è¿è¡Œ
cd backend
npm run dev
```

**é¢„æœŸè¾“å‡ºï¼š**
```
âœ… MongoDB connected successfully
âœ… Database indexes created successfully
Server running on port 5000
```

### 2. ç¡®ä¿å‰ç«¯æœåŠ¡æ­£åœ¨è¿è¡Œ

```bash
# åœ¨ frontend ç›®å½•ä¸‹è¿è¡Œ
cd frontend
npm run dev
```

**é¢„æœŸè¾“å‡ºï¼š**
```
VITE v5.x.x ready in xxx ms
âœ  Local:   http://localhost:3000/
```

### 3. æ£€æŸ¥MongoDBæ˜¯å¦è¿è¡Œ

```bash
# Windows
net start MongoDB

# æˆ–è€…æ£€æŸ¥æœåŠ¡çŠ¶æ€
sc query MongoDB
```

å¦‚æœMongoDBæœªå®‰è£…æˆ–æœªè¿è¡Œï¼Œè¯·å…ˆå®‰è£…å¹¶å¯åŠ¨MongoDBã€‚

---

## ğŸ” è¯¦ç»†æ’æŸ¥æ­¥éª¤

### æ­¥éª¤1ï¼šæ£€æŸ¥åç«¯æœåŠ¡çŠ¶æ€

#### æ–¹æ³•Aï¼šä½¿ç”¨æµè§ˆå™¨
æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š`http://localhost:5000/api/system/health`

**æˆåŠŸå“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "data": {
    "status": "healthy",
    "timestamp": "2025-10-28T...",
    "uptime": 123.45
  }
}
```

#### æ–¹æ³•Bï¼šä½¿ç”¨curl
```bash
curl http://localhost:5000/api/system/health
```

#### æ–¹æ³•Cï¼šä½¿ç”¨è¯Šæ–­å·¥å…·
æ‰“å¼€ `test-connection.html` æ–‡ä»¶åœ¨æµè§ˆå™¨ä¸­ï¼Œç‚¹å‡»"æµ‹è¯•åç«¯"æŒ‰é’®ã€‚

### æ­¥éª¤2ï¼šæ£€æŸ¥ç«¯å£å ç”¨

```bash
# Windows - æ£€æŸ¥5000ç«¯å£
netstat -ano | findstr :5000

# å¦‚æœç«¯å£è¢«å ç”¨ï¼Œæ‰¾åˆ°PIDå¹¶ç»“æŸè¿›ç¨‹
taskkill /PID <PID> /F
```

### æ­¥éª¤3ï¼šæ£€æŸ¥CORSé…ç½®

**åç«¯é…ç½®** (`backend/.env`):
```env
CORS_ORIGIN=http://localhost:3000
```

**å‰ç«¯é…ç½®** (`frontend/.env`):
```env
VITE_API_URL=http://localhost:5000/api
```

**é‡è¦ï¼š** ç¡®ä¿CORS_ORIGINä¸å‰ç«¯è¿è¡Œçš„åœ°å€åŒ¹é…ï¼

### æ­¥éª¤4ï¼šæ£€æŸ¥é˜²ç«å¢™

Windowsé˜²ç«å¢™å¯èƒ½é˜»æ­¢æœ¬åœ°è¿æ¥ï¼š

1. æ‰“å¼€ Windows Defender é˜²ç«å¢™
2. ç‚¹å‡»"å…è®¸åº”ç”¨é€šè¿‡é˜²ç«å¢™"
3. ç¡®ä¿ Node.js è¢«å…è®¸

æˆ–è€…ä¸´æ—¶å…³é—­é˜²ç«å¢™æµ‹è¯•ï¼š
```bash
# éœ€è¦ç®¡ç†å‘˜æƒé™
netsh advfirewall set allprofiles state off
```

### æ­¥éª¤5ï¼šæ£€æŸ¥ç½‘ç»œé…ç½®

åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œï¼š
```javascript
// æ£€æŸ¥ç½‘ç»œçŠ¶æ€
console.log('åœ¨çº¿çŠ¶æ€:', navigator.onLine)

// æµ‹è¯•APIè¿æ¥
fetch('http://localhost:5000/api/system/health')
  .then(r => r.json())
  .then(d => console.log('APIå“åº”:', d))
  .catch(e => console.error('APIé”™è¯¯:', e))
```

---

## ğŸ› å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ

### é”™è¯¯1: "Failed to fetch"
**åŸå› ï¼š** åç«¯æœåŠ¡æœªè¿è¡Œ

**è§£å†³ï¼š**
```bash
cd backend
npm run dev
```

### é”™è¯¯2: "EADDRINUSE: address already in use"
**åŸå› ï¼š** ç«¯å£5000å·²è¢«å ç”¨

**è§£å†³ï¼š**
```bash
# æ‰¾åˆ°å ç”¨ç«¯å£çš„è¿›ç¨‹
netstat -ano | findstr :5000

# ç»“æŸè¿›ç¨‹
taskkill /PID <PID> /F

# æˆ–è€…ä¿®æ”¹ç«¯å£
# åœ¨ backend/.env ä¸­ä¿®æ”¹ PORT=5001
```

### é”™è¯¯3: "CORS policy: No 'Access-Control-Allow-Origin'"
**åŸå› ï¼š** CORSé…ç½®ä¸æ­£ç¡®

**è§£å†³ï¼š**
1. æ£€æŸ¥ `backend/.env` ä¸­çš„ `CORS_ORIGIN`
2. ç¡®ä¿å€¼ä¸º `http://localhost:3000`ï¼ˆå‰ç«¯è¿è¡Œçš„åœ°å€ï¼‰
3. é‡å¯åç«¯æœåŠ¡

### é”™è¯¯4: "MongooseServerSelectionError"
**åŸå› ï¼š** MongoDBæœªè¿è¡Œæˆ–è¿æ¥å¤±è´¥

**è§£å†³ï¼š**
```bash
# å¯åŠ¨MongoDBæœåŠ¡
net start MongoDB

# æˆ–è€…æ£€æŸ¥ backend/.env ä¸­çš„ MONGODB_URI
MONGODB_URI=mongodb://localhost:27017/fortune-prediction
```

### é”™è¯¯5: "Cannot GET /api/..."
**åŸå› ï¼š** APIè·¯ç”±ä¸å­˜åœ¨

**è§£å†³ï¼š**
1. æ£€æŸ¥APIè·¯å¾„æ˜¯å¦æ­£ç¡®
2. æŸ¥çœ‹åç«¯æ—¥å¿—ç¡®è®¤è·¯ç”±å·²æ³¨å†Œ
3. ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„HTTPæ–¹æ³•ï¼ˆGET/POSTç­‰ï¼‰

### é”™è¯¯6: "Request timeout"
**åŸå› ï¼š** è¯·æ±‚è¶…æ—¶ï¼ˆ>10ç§’ï¼‰

**è§£å†³ï¼š**
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. æ£€æŸ¥åç«¯æ€§èƒ½
3. å¢åŠ è¶…æ—¶æ—¶é—´ï¼ˆåœ¨ `frontend/src/services/api.ts`ï¼‰

---

## ğŸ“Š ä½¿ç”¨è¯Šæ–­å·¥å…·

### æ–¹æ³•1ï¼šä½¿ç”¨test-connection.html

1. åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `test-connection.html`
2. é¡µé¢ä¼šè‡ªåŠ¨è¿è¡Œæ‰€æœ‰æµ‹è¯•
3. æŸ¥çœ‹æ¯ä¸ªæµ‹è¯•çš„ç»“æœ

### æ–¹æ³•2ï¼šä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·

1. æ‰“å¼€å‰ç«¯åº”ç”¨ï¼ˆhttp://localhost:3000ï¼‰
2. æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
3. åˆ‡æ¢åˆ° Network æ ‡ç­¾
4. ç‚¹å‡»å åœæŒ‰é’®
5. æŸ¥çœ‹å¤±è´¥çš„è¯·æ±‚è¯¦æƒ…

**æ£€æŸ¥é¡¹ï¼š**
- Status Codeï¼ˆçŠ¶æ€ç ï¼‰
- Responseï¼ˆå“åº”å†…å®¹ï¼‰
- Headersï¼ˆè¯·æ±‚å¤´ï¼‰
- Timingï¼ˆæ—¶é—´ï¼‰

### æ–¹æ³•3ï¼šæŸ¥çœ‹åç«¯æ—¥å¿—

åç«¯æ—¥å¿—ä¼šæ˜¾ç¤ºæ‰€æœ‰è¯·æ±‚ï¼š
```
[2025-10-28T...] [INFO] POST /api/divination/tarot
[2025-10-28T...] [INFO] Response time: 1234ms
```

---

## ğŸ”§ é…ç½®æ£€æŸ¥æ¸…å•

### åç«¯é…ç½® (backend/.env)
- [ ] PORT=5000
- [ ] NODE_ENV=development
- [ ] MONGODB_URI=mongodb://localhost:27017/fortune-prediction
- [ ] JWT_SECRET=ï¼ˆå·²è®¾ç½®ï¼‰
- [ ] CORS_ORIGIN=http://localhost:3000

### å‰ç«¯é…ç½® (frontend/.env)
- [ ] VITE_API_URL=http://localhost:5000/api

### æœåŠ¡çŠ¶æ€
- [ ] MongoDB æ­£åœ¨è¿è¡Œ
- [ ] åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œï¼ˆç«¯å£5000ï¼‰
- [ ] å‰ç«¯æœåŠ¡æ­£åœ¨è¿è¡Œï¼ˆç«¯å£3000ï¼‰
- [ ] é˜²ç«å¢™å…è®¸è¿æ¥

### ç½‘ç»œæµ‹è¯•
- [ ] å¯ä»¥è®¿é—® http://localhost:5000/api/system/health
- [ ] å¯ä»¥è®¿é—® http://localhost:3000
- [ ] CORS é…ç½®æ­£ç¡®
- [ ] æ— ç«¯å£å†²çª

---

## ğŸš€ å®Œæ•´å¯åŠ¨æµç¨‹

### 1. å¯åŠ¨MongoDB
```bash
# Windows
net start MongoDB

# éªŒè¯
mongo --eval "db.version()"
```

### 2. å¯åŠ¨åç«¯
```bash
cd backend
npm install  # é¦–æ¬¡è¿è¡Œ
npm run dev
```

**ç­‰å¾…çœ‹åˆ°ï¼š**
```
âœ… MongoDB connected successfully
Server running on port 5000
```

### 3. å¯åŠ¨å‰ç«¯
```bash
cd frontend
npm install  # é¦–æ¬¡è¿è¡Œ
npm run dev
```

**ç­‰å¾…çœ‹åˆ°ï¼š**
```
âœ  Local:   http://localhost:3000/
```

### 4. æµ‹è¯•è¿æ¥
æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š
- å‰ç«¯ï¼šhttp://localhost:3000
- åç«¯å¥åº·æ£€æŸ¥ï¼šhttp://localhost:5000/api/system/health
- è¯Šæ–­å·¥å…·ï¼šæ‰“å¼€ test-connection.html

---

## ğŸ’¡ å¼€å‘æŠ€å·§

### 1. ä½¿ç”¨å¹¶å‘å¯åŠ¨
åˆ›å»º `start-all.bat`ï¼š
```batch
@echo off
start cmd /k "cd backend && npm run dev"
timeout /t 5
start cmd /k "cd frontend && npm run dev"
start http://localhost:3000
```

### 2. ç›‘æ§æ—¥å¿—
```bash
# åç«¯æ—¥å¿—
cd backend
npm run dev | tee backend.log

# å‰ç«¯æ—¥å¿—
cd frontend
npm run dev | tee frontend.log
```

### 3. å¿«é€Ÿé‡å¯
```bash
# åœæ­¢æ‰€æœ‰Nodeè¿›ç¨‹
taskkill /F /IM node.exe

# é‡æ–°å¯åŠ¨
cd backend && npm run dev
cd frontend && npm run dev
```

---

## ğŸ“ ä»ç„¶æ— æ³•è§£å†³ï¼Ÿ

### æ”¶é›†è¯Šæ–­ä¿¡æ¯

1. **åç«¯æ—¥å¿—**
   - å¤åˆ¶åç«¯æ§åˆ¶å°çš„å®Œæ•´è¾“å‡º

2. **å‰ç«¯é”™è¯¯**
   - æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰
   - å¤åˆ¶ Console å’Œ Network æ ‡ç­¾çš„é”™è¯¯ä¿¡æ¯

3. **ç¯å¢ƒä¿¡æ¯**
   ```bash
   node --version
   npm --version
   mongo --version
   ```

4. **ç«¯å£çŠ¶æ€**
   ```bash
   netstat -ano | findstr :5000
   netstat -ano | findstr :3000
   netstat -ano | findstr :27017
   ```

5. **é…ç½®æ–‡ä»¶**
   - backend/.env
   - frontend/.env

### æäº¤é—®é¢˜æ—¶åŒ…å«ï¼š
- é”™è¯¯æˆªå›¾
- å®Œæ•´çš„é”™è¯¯æ¶ˆæ¯
- åç«¯å’Œå‰ç«¯æ—¥å¿—
- ç¯å¢ƒä¿¡æ¯
- å·²å°è¯•çš„è§£å†³æ­¥éª¤

---

## âœ… æˆåŠŸæ ‡å¿—

å½“ä¸€åˆ‡æ­£å¸¸æ—¶ï¼Œä½ åº”è¯¥çœ‹åˆ°ï¼š

1. **åç«¯æ§åˆ¶å°ï¼š**
   ```
   âœ… MongoDB connected successfully
   âœ… Database indexes created successfully
   Server running on port 5000
   ```

2. **å‰ç«¯æ§åˆ¶å°ï¼š**
   ```
   VITE v5.x.x ready in xxx ms
   âœ  Local:   http://localhost:3000/
   ```

3. **æµè§ˆå™¨ï¼š**
   - å¯ä»¥è®¿é—® http://localhost:3000
   - ç‚¹å‡»å åœæŒ‰é’®æ­£å¸¸å·¥ä½œ
   - Network æ ‡ç­¾æ˜¾ç¤º 200 çŠ¶æ€ç 
   - æ—  CORS é”™è¯¯

4. **å¥åº·æ£€æŸ¥ï¼š**
   - http://localhost:5000/api/system/health è¿”å› healthy

---

**ç¥ä½ å¥½è¿ï¼å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œè¯·ä½¿ç”¨ test-connection.html è¯Šæ–­å·¥å…·è·å–è¯¦ç»†ä¿¡æ¯ã€‚** ğŸ‰

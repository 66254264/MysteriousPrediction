<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APIæµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-box {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            background: #2196F3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        button:hover {
            background: #0b7dda;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: bold;
            margin: 5px 0;
        }
        .success { background: #4CAF50; color: white; }
        .error { background: #f44336; color: white; }
        .pending { background: #FFC107; color: black; }
        pre {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            max-height: 400px;
        }
        .input-group {
            margin: 10px 0;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .input-group input, .input-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª APIåŠŸèƒ½æµ‹è¯•</h1>
    
    <div class="test-box">
        <h2>1. å¥åº·æ£€æŸ¥</h2>
        <button onclick="testHealth()">æµ‹è¯•å¥åº·æ£€æŸ¥</button>
        <div id="health-result"></div>
    </div>

    <div class="test-box">
        <h2>2. å¡”ç½—ç‰Œå åœï¼ˆæ— éœ€ç™»å½•ï¼‰</h2>
        <div class="input-group">
            <label>é—®é¢˜ï¼š</label>
            <input type="text" id="tarot-question" value="æˆ‘çš„æœªæ¥ä¼šæ€æ ·ï¼Ÿ" />
        </div>
        <div class="input-group">
            <label>ç‰Œé˜µï¼š</label>
            <select id="tarot-spread">
                <option value="single">å•å¼ ç‰Œ</option>
                <option value="three">ä¸‰å¼ ç‰Œ</option>
                <option value="celtic">å‡¯å°”ç‰¹åå­—</option>
            </select>
        </div>
        <button onclick="testTarot()">æµ‹è¯•å¡”ç½—ç‰Œ</button>
        <div id="tarot-result"></div>
    </div>

    <div class="test-box">
        <h2>3. æ˜Ÿåº§é¢„æµ‹ï¼ˆæ— éœ€ç™»å½•ï¼‰</h2>
        <div class="input-group">
            <label>å‡ºç”Ÿæ—¥æœŸï¼š</label>
            <input type="date" id="astrology-date" value="1990-01-01" />
        </div>
        <button onclick="testAstrology()">æµ‹è¯•æ˜Ÿåº§é¢„æµ‹</button>
        <div id="astrology-result"></div>
    </div>

    <div class="test-box">
        <h2>4. å…«å­—ç®—å‘½ï¼ˆæ— éœ€ç™»å½•ï¼‰</h2>
        <div class="input-group">
            <label>å‡ºç”Ÿæ—¥æœŸï¼š</label>
            <input type="date" id="bazi-date" value="1990-01-01" />
        </div>
        <div class="input-group">
            <label>å‡ºç”Ÿæ—¶é—´ï¼ˆå°æ—¶ï¼‰ï¼š</label>
            <input type="number" id="bazi-hour" value="10" min="0" max="23" />
        </div>
        <div class="input-group">
            <label>å‡ºç”Ÿæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰ï¼š</label>
            <input type="number" id="bazi-minute" value="30" min="0" max="59" />
        </div>
        <div class="input-group">
            <label>æ€§åˆ«ï¼š</label>
            <select id="bazi-gender">
                <option value="male">ç”·</option>
                <option value="female">å¥³</option>
            </select>
        </div>
        <button onclick="testBazi()">æµ‹è¯•å…«å­—ç®—å‘½</button>
        <div id="bazi-result"></div>
    </div>

    <div class="test-box">
        <h2>5. å‘¨æ˜“å åœï¼ˆæ— éœ€ç™»å½•ï¼‰</h2>
        <div class="input-group">
            <label>é—®é¢˜ï¼š</label>
            <input type="text" id="yijing-question" value="æˆ‘åº”è¯¥å¦‚ä½•å†³ç­–ï¼Ÿ" />
        </div>
        <div class="input-group">
            <label>æ–¹æ³•ï¼š</label>
            <select id="yijing-method">
                <option value="coins">é“œé’±æ³•</option>
                <option value="yarrow">è“è‰æ³•</option>
                <option value="numbers">æ•°å­—æ³•</option>
            </select>
        </div>
        <button onclick="testYijing()">æµ‹è¯•å‘¨æ˜“å åœ</button>
        <div id="yijing-result"></div>
    </div>

    <script>
        const API_URL = 'http://localhost:5000/api';

        function showResult(elementId, status, message, data = null) {
            const element = document.getElementById(elementId);
            let html = `<p><span class="status ${status}">${message}</span></p>`;
            if (data) {
                html += `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            }
            element.innerHTML = html;
        }

        async function testHealth() {
            showResult('health-result', 'pending', 'æµ‹è¯•ä¸­...');
            try {
                const response = await fetch(`${API_URL}/system/health`);
                const data = await response.json();
                if (response.ok) {
                    showResult('health-result', 'success', 'âœ“ å¥åº·æ£€æŸ¥æˆåŠŸ', data);
                } else {
                    showResult('health-result', 'error', 'âœ— å¥åº·æ£€æŸ¥å¤±è´¥', data);
                }
            } catch (error) {
                showResult('health-result', 'error', `âœ— é”™è¯¯: ${error.message}`);
            }
        }

        async function testTarot() {
            showResult('tarot-result', 'pending', 'æµ‹è¯•ä¸­...');
            try {
                const question = document.getElementById('tarot-question').value;
                const spreadType = document.getElementById('tarot-spread').value;

                const response = await fetch(`${API_URL}/divination/tarot`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        question,
                        spreadType,
                        name: 'æµ‹è¯•ç”¨æˆ·'
                    })
                });

                const data = await response.json();
                if (response.ok && data.success) {
                    showResult('tarot-result', 'success', 'âœ“ å¡”ç½—ç‰Œå åœæˆåŠŸ', data);
                } else {
                    showResult('tarot-result', 'error', 'âœ— å¡”ç½—ç‰Œå åœå¤±è´¥', data);
                }
            } catch (error) {
                showResult('tarot-result', 'error', `âœ— é”™è¯¯: ${error.message}`);
            }
        }

        async function testAstrology() {
            showResult('astrology-result', 'pending', 'æµ‹è¯•ä¸­...');
            try {
                const birthDate = document.getElementById('astrology-date').value;

                const response = await fetch(`${API_URL}/divination/astrology`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        birthDate,
                        name: 'æµ‹è¯•ç”¨æˆ·'
                    })
                });

                const data = await response.json();
                if (response.ok && data.success) {
                    showResult('astrology-result', 'success', 'âœ“ æ˜Ÿåº§é¢„æµ‹æˆåŠŸ', data);
                } else {
                    showResult('astrology-result', 'error', 'âœ— æ˜Ÿåº§é¢„æµ‹å¤±è´¥', data);
                }
            } catch (error) {
                showResult('astrology-result', 'error', `âœ— é”™è¯¯: ${error.message}`);
            }
        }

        async function testBazi() {
            showResult('bazi-result', 'pending', 'æµ‹è¯•ä¸­...');
            try {
                const birthDate = document.getElementById('bazi-date').value;
                const hour = parseInt(document.getElementById('bazi-hour').value);
                const minute = parseInt(document.getElementById('bazi-minute').value);
                const gender = document.getElementById('bazi-gender').value;

                const response = await fetch(`${API_URL}/divination/bazi`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        birthDate,
                        birthTime: { hour, minute },
                        gender,
                        name: 'æµ‹è¯•ç”¨æˆ·'
                    })
                });

                const data = await response.json();
                if (response.ok && data.success) {
                    showResult('bazi-result', 'success', 'âœ“ å…«å­—ç®—å‘½æˆåŠŸ', data);
                } else {
                    showResult('bazi-result', 'error', 'âœ— å…«å­—ç®—å‘½å¤±è´¥', data);
                }
            } catch (error) {
                showResult('bazi-result', 'error', `âœ— é”™è¯¯: ${error.message}`);
            }
        }

        async function testYijing() {
            showResult('yijing-result', 'pending', 'æµ‹è¯•ä¸­...');
            try {
                const question = document.getElementById('yijing-question').value;
                const method = document.getElementById('yijing-method').value;

                const response = await fetch(`${API_URL}/divination/yijing`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        question,
                        method
                    })
                });

                const data = await response.json();
                if (response.ok && data.success) {
                    showResult('yijing-result', 'success', 'âœ“ å‘¨æ˜“å åœæˆåŠŸ', data);
                } else {
                    showResult('yijing-result', 'error', 'âœ— å‘¨æ˜“å åœå¤±è´¥', data);
                }
            } catch (error) {
                showResult('yijing-result', 'error', `âœ— é”™è¯¯: ${error.message}`);
            }
        }

        // è‡ªåŠ¨æµ‹è¯•å¥åº·æ£€æŸ¥
        window.addEventListener('load', () => {
            setTimeout(testHealth, 500);
        });
    </script>
</body>
</html>

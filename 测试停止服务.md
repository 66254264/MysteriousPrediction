# 停止服务脚本测试

## 当前运行的服务

### 检测结果（2025-10-28）

| 端口 | 进程ID | 状态 | 服务 |
|------|--------|------|------|
| 3000 | 25756 | Listen | 前端服务 |
| 5000 | 23972 | Listen | 后端服务 |

## 测试步骤

### 方法1：使用PowerShell脚本（推荐）

1. 右键点击 `停止服务.ps1`
2. 选择"使用PowerShell运行"
3. 观察输出信息
4. 验证服务是否停止

### 方法2：使用批处理脚本

1. 双击 `停止服务.bat`
2. 观察输出信息
3. 验证服务是否停止

### 方法3：手动验证

**检查端口占用：**
```powershell
# PowerShell命令
Get-NetTCPConnection -LocalPort 3000,5000 -State Listen -ErrorAction SilentlyContinue

# 或使用netstat
netstat -ano | findstr :3000
netstat -ano | findstr :5000
```

**预期结果：**
- 执行停止脚本后，上述命令应该没有输出
- 表示端口已释放，服务已停止

## 验证命令

### 快速验证
```powershell
# 检查Node.js进程
Get-Process -Name node -ErrorAction SilentlyContinue

# 检查端口占用
Get-NetTCPConnection -LocalPort 3000,5000 -State Listen -ErrorAction SilentlyContinue
```

### 详细验证
```powershell
# 检查3000端口
$port3000 = Get-NetTCPConnection -LocalPort 3000 -State Listen -ErrorAction SilentlyContinue
if ($port3000) {
    Write-Host "⚠️  端口3000仍被占用" -ForegroundColor Red
    Write-Host "进程ID: $($port3000.OwningProcess)"
} else {
    Write-Host "✅ 端口3000已释放" -ForegroundColor Green
}

# 检查5000端口
$port5000 = Get-NetTCPConnection -LocalPort 5000 -State Listen -ErrorAction SilentlyContinue
if ($port5000) {
    Write-Host "⚠️  端口5000仍被占用" -ForegroundColor Red
    Write-Host "进程ID: $($port5000.OwningProcess)"
} else {
    Write-Host "✅ 端口5000已释放" -ForegroundColor Green
}
```

## 测试结果记录

### 测试1：PowerShell脚本
- [ ] 执行成功
- [ ] 前端服务已停止
- [ ] 后端服务已停止
- [ ] 端口3000已释放
- [ ] 端口5000已释放

### 测试2：批处理脚本
- [ ] 执行成功
- [ ] 前端服务已停止
- [ ] 后端服务已停止
- [ ] 端口3000已释放
- [ ] 端口5000已释放

## 故障排除

如果脚本无法停止服务：

1. **以管理员身份运行**
   ```
   右键点击脚本 -> 以管理员身份运行
   ```

2. **手动停止进程**
   ```powershell
   # 停止前端（PID 25756）
   Stop-Process -Id 25756 -Force
   
   # 停止后端（PID 23972）
   Stop-Process -Id 23972 -Force
   ```

3. **强制停止所有Node.js进程**
   ```powershell
   Get-Process -Name node | Stop-Process -Force
   ```

## 注意事项

1. 停止服务前，确保已保存所有工作
2. 如果有未提交的代码，先提交或暂存
3. 停止服务后，可以使用 `启动服务.bat` 重新启动

---

**测试时间：** 待测试
**测试人员：** 待测试
**测试环境：** Windows 10/11
